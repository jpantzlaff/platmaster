(function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(i=!1)}i&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},a={app:0},r=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0132":function(e,t,n){},"0bc6":function(e,t,n){},"1ca7":function(e,t,n){"use strict";var i=n("c26c"),a=n.n(i);a.a},"1ed9":function(e,t,n){"use strict";var i=n("0132"),a=n.n(i);a.a},2979:function(e,t,n){"use strict";var i=n("9e3c"),a=n.n(i);a.a},"2bae":function(e,t,n){},"33ad":function(e,t,n){"use strict";var i=n("c613"),a=n.n(i);a.a},"3b19":function(e,t,n){},"3f68":function(e,t,n){},4732:function(e,t,n){"use strict";var i=n("0bc6"),a=n.n(i);a.a},"4b4c":function(e,t,n){"use strict";var i=n("d34f"),a=n.n(i);a.a},"4f98":function(e,t,n){"use strict";var i=n("3f68"),a=n.n(i);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var i=n("3835"),a=(n("96cf"),n("1da1")),r=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("UiToolbar",{attrs:{id:"header",brand:"PlatMaster",title:e.header,removeNavIcon:""}}),"welcome"!==e.activeView?n("UiIconButton",{attrs:{id:"close",icon:"close",size:"small"},on:{click:e.home}}):e._e(),n("div",{attrs:{id:"rest"}},["templates"===e.activeView?n("Templates"):"projects"===e.activeView?n("Projects"):"editor"===e.activeView?n("Editor"):n("Welcome")],1)],1)},s=[],c=n("287d"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"editor"}},[e.documentAddOpen?n("DocumentAdd"):e._e(),e.project.documents.length<1?n("div",{staticClass:"no-documents"},[n("h3",[e._v("This project doesn't have any documents added to it yet.")])]):e._e()],1)},u=[],d=n("5530"),p=(n("1fff"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("UiModal",{ref:"modal",staticClass:"document-add",attrs:{size:"fullscreen",title:e.project.name+": Add Document",dismissOn:"close-button",transition:"fade"},on:{hide:e.close}},[e.file?n("div",{staticClass:"georef"},[n("div",{staticClass:"map-parent"},[n("div",{staticClass:"georef-instruction"},[n("h3",[e._v(e._s(e.georefInstruction))])]),n("div",{ref:"map",staticClass:"map"})])]):n("div",{staticClass:"upload"},[e.project.documents.length<1?n("h3",{staticClass:"upload-instruction",staticStyle:{margin:"0"}},[e._v(" This project doesn't have any documents added to it yet. ")]):e._e(),n("h3",{staticClass:"upload-instruction"},[e._v("Choose a document to georeference.")]),n("UiFileupload",{attrs:{name:"document",accept:"image/jpeg,image/png",size:"large",label:"Select File"},on:{change:e.handleFile}})],1),n("Coordinate",{ref:"tie1",attrs:{identity:"start"},on:{complete:e.setTie}}),"None"===e.project.bearingBasis?n("Coordinate",{ref:"tie2",attrs:{identity:"end"},on:{complete:e.setTie}}):e._e(),n("DirectionDistance",{ref:"dd",on:{complete:e.setDD}})],1)}),m=[],f=(n("d81d"),n("2b3d"),n("2909")),h=(n("5bc0"),n("ac29")),v=n("0af5"),b=n("c810"),g=n("5eee"),y=n("f5dd"),w=n("bd02"),j=n("e7df"),x=n("3e6b"),C=n("5831"),T=n("a2c7"),k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"coordinate",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirm(t)}}},[n("div",{staticClass:"xy"},[n("p",{staticClass:"xy-label"},[e._v("X:")]),n("UiTextbox",{ref:"x",staticClass:"x",model:{value:e.x,callback:function(t){e.x=t},expression:"x"}}),n("p",{staticClass:"xy-label"},[e._v("Y:")]),n("UiTextbox",{ref:"y",staticClass:"y",model:{value:e.y,callback:function(t){e.y=t},expression:"y"}})],1),n("div",{staticClass:"bottom"},[n("UiSelect",{staticClass:"crs",attrs:{disableFilter:!0,hasSearch:!0,loading:e.crsLoading,"no-results":e.crsNoResult,options:e.crsOptions},on:{"query-change":e.crsQuery},model:{value:e.crs,callback:function(t){e.crs=t},expression:"crs"}}),n("UiIconButton",{staticClass:"confirm",attrs:{icon:"check",disabled:!e.valid},on:{click:e.confirm}})],1)])},U=[],_=(n("99af"),n("b0c0"),n("a9e3"),n("ac1f"),n("5319"),n("d4ec")),O=n("bee2"),B=n("aa1a"),S=n.n(B),D=n("a79f");n("4160"),n("4fad"),n("159b");function R(e,t){var n=0,i=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var c=o.value;c===t&&n++}}catch(l){a=!0,r=l}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}return n}function E(e){return e*(Math.PI/180)}function M(e){var t=Object(i["a"])(e,3),n=t[0],a=t[1],r=t[2];if(!(n>=0&&n<360))throw Error("Degrees outside range 0-360");if(!(a>=0&&a<60))throw Error("Minutes outside range 0-60");if(!(r>=0&&r<60))throw Error("Seconds outside range 0-60");return n+a/60+r/3600}function N(e){var t=e;return t=90-t,t<0&&(t+=360),E(t)}function I(e,t){return P.apply(this,arguments)}function P(){return P=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=new URL(t),Object.entries(n).forEach((function(e){var t;return(t=i.searchParams).append.apply(t,Object(f["a"])(e))})),e.prev=2,e.next=5,fetch(i.href).then((function(e){return e.text()}));case 5:a=e.sent,e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](2),Error("No network connection.");case 11:return e.prev=11,e.abrupt("return",JSON.parse(a));case 15:throw e.prev=15,e.t1=e["catch"](11),Error("Request to ".concat(t," did not return JSON. Response:\n").concat(a));case 18:case"end":return e.stop()}}),e,null,[[2,8],[11,15]])}))),P.apply(this,arguments)}var F=function(){function e(t){Object(_["a"])(this,e),this.accuracy=t.accuracy,this.area=t.area,this.code=t.code,this.kind=t.kind,this.name=t.name,this.offset=0,this.proj4=t.proj4,this.unit=t.unit}return Object(O["a"])(e,[{key:"destination",value:function(e,t,n){var a=Object(i["a"])(e,2),r=a[0],o=a[1],s=N(t);return[r+n*Math.cos(s),o+n*Math.sin(s)]}},{key:"fromWgs84",value:function(e){return Object(D["a"])(this.proj4,e)}},{key:"gridConvergence",value:function(e,t){return"CRS-GEOGCRS"===this.kind?0:S()(this.toWgs84([e,t]),this.toWgs84([e,t+10]))}},{key:"project",value:function(e,t){return Object(D["a"])(this.proj4,e.proj4,t)}},{key:"setUnit",value:function(e){this.proj4=this.proj4.replace(/units=\w+ ?/,"units=".concat(e," ")),this.unit=e}},{key:"toWgs84",value:function(e){return Object(D["a"])(this.proj4).inverse(e)}}],[{key:"getMagDecl",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,o,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=Object(i["a"])(t,2),r=a[0],o=a[1],s=n.getFullYear(),!(s>=2019)){e.next=6;break}c="WMM",e.next=15;break;case 6:if(!(s>=2e3)){e.next=10;break}c="EMM",e.next=15;break;case 10:if(!(s>=1590)){e.next=14;break}c="IGRF",e.next=15;break;case 14:throw Error("Magnetic declination data are not available for years prior to 1590.");case 15:return e.next=17,I("https://www.ngdc.noaa.gov/geomag-web/calculators/calculateDeclination",{lat1:o,lat1Hemisphere:o<0?"S":"N",lon1:r,lon1Hemisphere:r<0?"W":"E",magneticComponent:"d",model:c,resultFormat:"json",startDay:n.getDate(),startMonth:n.getMonth()+1,startYear:s});case 17:return l=e.sent,e.prev=18,e.abrupt("return",l.result[0].declination);case 22:throw e.prev=22,e.t0=e["catch"](18),Error("A magnetic declination could not be calculated.");case 25:case"end":return e.stop()}}),e,null,[[18,22]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"newAeqd",value:function(t,n,i){var a=new e;return a.proj4="+proj=aeqd +lat_0=".concat(t," +lon_0=").concat(n," +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=").concat(i," +no_defs"),a}},{key:"queryProj",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I("https://epsg.io",{format:"json",q:n});case 2:return i=t.sent,t.abrupt("return",Array.isArray(null===i||void 0===i?void 0:i.results)?i.results.map((function(t){return new e({accuracy:t.accuracy,area:t.area,code:t.code,kind:t.kind,name:t.name,proj4:t.proj4,unit:t.unit})})):[]);case 4:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()}]),e}(),G={name:"Coordinate",props:["identity"],computed:{valid:function(){return Boolean(this.xValid&&this.yValid&&this.crs.value)},xValid:function(){return Boolean(Number(this.x))},yValid:function(){return Boolean(Number(this.y))}},data:function(){return{crs:vt.project.documentCrs||{},crsLoading:!1,crsNoResult:!1,crsOptions:[],x:null,y:null}},methods:{confirm:function(){this.valid&&this.$emit("complete",{crs:this.crs.value,identity:this.identity,x:Number(this.x),y:Number(this.y)})},crsQuery:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.crsLoading=!0,F.queryProj(e).then((function(e){t.crsNoResult=!1,t.crsOptions=e.map((function(e){return{label:"SRID:".concat(e.code," – ").concat(e.name),value:e}}))})).catch((function(){return t.crsNoResult=!0})).finally((function(){return t.crsLoading=!1}));case 2:case"end":return n.stop()}}),n)})))()}},components:{UiIconButton:c["UiIconButton"],UiSelect:c["UiSelect"],UiTextbox:c["UiTextbox"]}},$=G,A=(n("4b4c"),n("fe81"),n("2877")),V=Object(A["a"])($,k,U,!1,null,"6f042682",null),Y=V.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dd",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirm(t)}}},[n("UiTextbox",{ref:"direction",staticClass:"direction",attrs:{placeholder:"Direction"},model:{value:e.directionRaw,callback:function(t){e.directionRaw=t},expression:"directionRaw"}}),n("p",{staticClass:"xy-label"},[e._v("Y:")]),n("UiTextbox",{ref:"distance",staticClass:"distance",attrs:{placeholder:"Distance"},model:{value:e.distanceRaw,callback:function(t){e.distanceRaw=t},expression:"distanceRaw"}}),n("UiIconButton",{staticClass:"confirm",attrs:{icon:"check",disabled:!e.valid},on:{click:e.confirm}})],1)},z=[],W=(n("f00c"),n("caad"),n("a15b"),n("fb6a"),n("45fc"),n("9129"),n("1276"),n("f403")),q=n("6c77"),J=n("8682"),K=n("ce2c"),Z=n("83a6"),Q={"YYYY-MM-DD":"en-CA","MM/DD/YYYY":"en-US","DD/MM/YYYY":"en-GB"};function H(e){return e.toLocaleDateString(Q[vt.appearance.dateFormat])}function X(e){var t=vt.input.directionFormat;if("45.56"===t){var n=Number(e);if(Number.isFinite(n)){if(n>=0&&n<360)return n;throw Error("Number outside range 0-360")}throw Error("Invalid characters in string")}var i="N 45-33-36 E"===t?"-":".",a=e.replace(/ /g,""),r=a[0].toUpperCase(),o=a.slice(-1).toUpperCase(),s=a.slice(1,-1).split(i).map((function(e){return Number(e)}));if(!["N","S"].includes(r))throw Error("Invalid leading direction");if(!["E","W"].includes(o))throw Error("Invalid trailing direction");if(s.length<3||s.some((function(e){return Number.isNaN(e)})))throw Error("Invalid number");if(s[0]>90)throw Error("Invalid number");var c=M(s);return"N"===r?"E"===o?c:360-c:"E"===o?180-c:180+c}console.log(X);new Intl.NumberFormat("en-US").format,new Intl.NumberFormat("de-DE").format;var ee={"12-hour":"en-US","24-hour":"en-GB"};function te(e){return e.toLocaleTimeString(ee[vt.appearance.timeFormat],{timeStyle:"short"})}function ne(){return Number(getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2))}function ie(e){var t,n=vt.input.distanceFormat,i=n.slice(-3)[0],a=R(e,"."),r=R(e,",");if("1234.56"===n){if(r>0)throw Error("String contains an invalid character");t=Number(e)}else if("."===i){if(a>0)throw Error("String contains an invalid character");t=Number(e.replace(/[ \,]/g,""))}else{if(r>0)throw Error("String contains an invalid character");t=Number(e.replace(/[ \.]/g,"").replace(/\,/g,"."))}if(Number.isFinite(t))return t;throw Error("String contains an invalid character")}function ae(e){document.documentElement.style.setProperty("--color2",e)}function re(e){document.documentElement.style.setProperty("--color1",e)}function oe(e){document.documentElement.style.setProperty("--editor-color",e)}function se(e){document.documentElement.style.setProperty("--text-color",e),document.documentElement.style.setProperty("--light-text-color",e.slice(0,7)+"77")}function ce(e){for(var t=e.getGeometry(),n=[new q["c"]({stroke:new J["a"]({color:[255,255,255,1],width:5})}),new q["c"]({stroke:new J["a"]({color:[0,153,255,1],width:3})})],i=0,a=["getFirstCoordinate","getLastCoordinate"];i<a.length;i++){var r=a[i];n.push(new q["c"]({geometry:new W["a"](t[r]()),image:new K["a"]({radius:6,fill:new Z["a"]({color:[0,153,255,1]}),stroke:new J["a"]({color:[255,255,255,1],width:1.5})}),zIndex:1/0}))}return n}var le={name:"DirectionDistance",computed:{valid:function(){return Boolean(this.directionValid&&this.distanceValid)},directionValid:function(){return Number.isFinite(this.direction)},distanceValid:function(){return Number.isFinite(this.distance)}},data:function(){return{direction:null,distance:null,directionRaw:null,distanceRaw:null}},methods:{confirm:function(){this.valid&&this.$emit("complete",{direction:this.direction,distance:this.distance})}},watch:{directionRaw:function(e){try{this.direction=X(e)}catch(t){this.direction=null}},distanceRaw:function(e){try{this.distance=ie(e)}catch(t){this.distance=null}}},components:{UiIconButton:c["UiIconButton"],UiTextbox:c["UiTextbox"]}},ue=le,de=(n("fff7"),n("9040"),Object(A["a"])(ue,L,z,!1,null,"06b12016",null)),pe=de.exports,me=function e(){Object(_["a"])(this,e),this.buffer=null,this.tie1={pixel:[],source:[],wgs84:[]},this.tie2={pixel:[],source:[],wgs84:[]}},fe=n("0710"),he=n("c50a"),ve=function(){function e(){Object(_["a"])(this,e),this.id=Object(he["a"])(),this.crs=null,this.bearingBasis=null,this.bearingBasisDate=null,this.distanceBasis=null,this.documents=[],this.documentCrs={},this.lastModified=new Date,this.name="Untitled",this.unit=null}return Object(O["a"])(e,null,[{key:"fromTemplate",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new e,i.documentCrs=n.crs.value?new F(n.crs.value):null,i.bearingBasis=n.bearingBasisType,i.bearingBasisDate=n.bearingBasisDate,i.distanceBasis=n.distanceBasisType,"Grid"===i.bearingBasis&&"Grid"===i.distanceBasis&&(i.crs=new F(n.crs.value)),i.name=n.name,i.unit=n.distanceUnit.value,t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()}]),e}(),be=function e(){Object(_["a"])(this,e),this.id=Object(he["a"])(),this.bearingBasisDate=null,this.bearingBasisType="None",this.crs={},this.distanceBasisType="Ground",this.distanceUnits=[{label:"Meter",value:"m"},{label:"Foot (International)",value:"ft"},{label:"Foot (US)",value:"us-ft"}],this.distanceUnit=this.distanceUnits[0],this.lastUsed=new Date,this.name="Untitled"},ge={name:"DocumentAdd",mounted:function(){this.$refs.modal.open()},destroyed:function(){URL.revokeObjectURL(this.objectUrl)},props:{},computed:{georefInstruction:function(){return 0===this.stage?"Draw a line that is coincident with one of the lines on the document. The line must start ".concat("None"!==this.project.bearingBasis?"at a point":"and end at points"," with known geographic coordinates."):1===this.stage?"Provide the geographic coordinates at the start of the line.":2===this.stage?"Provide the direction and distance of the line, as indicated on the document.":"Provide the geographic coordinates at the end of the line."}},data:function(){return{document:null,draw:null,end:null,file:null,line:null,midpoint:null,objectUrl:null,ol:null,project:vt.project,stage:0,start:null}},methods:{completeDrawing:function(e){this.line=e.feature.getGeometry(),this.start=this.line.getFirstCoordinate(),this.midpoint=this.line.getCoordinateAt(.5),this.end=this.line.getLastCoordinate(),this.ol.removeInteraction(this.draw),this.stage=1,this.ol.addOverlay(new fe["a"]({element:this.$refs.tie1.$el,offset:[20,-40],position:this.start}))},close:function(){this.$emit("close")},handleFile:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,a,r,o,s,c,l,u,d,p,m,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.document=new me,i=e[0],t.file=i,n.next=5,i.arrayBuffer();case 5:return t.document.buffer=n.sent,t.objectUrl=URL.createObjectURL(i),a=new Image,a.src=t.objectUrl,n.next=11,a.decode();case 11:r=a.height,o=a.width,s=[0,0,o,r],c=new y["a"]({code:"doc",units:"pixels",extent:s}),l=new T["a"]({extent:s,projection:c,center:Object(v["x"])(s),zoom:0,minZoom:-100,maxZoom:10,enableRotation:!1}),u=new C["a"],d=new x["a"]({source:u,style:ce}),p=new j["a"]({url:t.objectUrl,projection:c,imageExtent:s}),vt.appearance.darkEditor?(f=new w["a"]({sources:[p],operation:function(e){var t=e[0];return t[0]=Math.abs(t[0]-255),t[1]=Math.abs(t[1]-255),t[2]=Math.abs(t[2]-255),t}}),m=new b["a"]({source:f})):m=new b["a"]({source:p}),t.ol=new g["a"]({layers:[m,d],target:t.$refs.map,view:l}),l.fit(s),l.setMinZoom(l.getZoom()),t.draw=new h["a"]({source:u,type:"LineString",maxPoints:2}),t.ol.addInteraction(t.draw),t.draw.on("drawend",t.completeDrawing);case 25:case"end":return n.stop()}}),n)})))()},setDD:function(e){var t=e.direction,n=e.distance;if("None"===this.project.bearingBasis)this.ol.addOverlay(new fe["a"]({element:this.$refs.tie2.$el,offset:[20,-40],position:this.end}));else{var i=this.project.crs.destination(this.document.tie1.document,t,n);this.document.tie2={pixel:this.end,source:i,wgs84:this.project.crs.toWgs84(i)}}},setTie:function(e){console.log(e);var t=e.crs,n=e.identity,i=e.x,a=e.y,r=this.document.tie2;r.document="None"===this.project.bearingBasis||t.code===this.project.documentCrs.code?[i,a]:t.project(this.project.documentCrs,[i,a]),r.pixel=this[n],r.wgs84=t.toWgs84([i,a]),console.log(this.document)}},watch:{"document.tie1":function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.wgs84.length){e.next=2;break}return e.abrupt("return");case 2:if(this.project.crs){e.next=12;break}if(n=Object(i["a"])(t.wgs84,2),a=n[0],r=n[1],this.project.crs=F.newAeqd(r,a,this.project.unit),"Magnetic north"!==this.project.bearingBasis){e.next=11;break}return e.next=8,F.getMagDecl([a,r],this.project.bearingBasisDate);case 8:this.project.crs.offset=e.sent,e.next=12;break;case 11:"Grid"===this.project.bearingBasis&&(this.project.crs.offset=(o=this.project.documentCrs).gridConvergence.apply(o,Object(f["a"])(t.source)));case 12:this.stage=2,this.ol.addOverlay(new fe["a"]({element:this.$refs.dd.$el,offset:[20,-40],position:this.midpoint}));case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),"document.tie2":function(e){e.wgs84.length}},components:{Coordinate:Y,DirectionDistance:pe,UiFileupload:c["UiFileupload"],UiModal:c["UiModal"]}},ye=ge,we=(n("9795"),n("4f98"),Object(A["a"])(ye,p,m,!1,null,"680e0507",null)),je=we.exports,xe={name:"Editor",mounted:function(){this.project.documents.length<1&&(this.documentAddOpen=!0)},data:function(){return Object(d["a"])({},vt,{documentAddOpen:!1,project:vt.project})},methods:{newProject:function(){this.$emit("newProject")}},components:{DocumentAdd:je}},Ce=xe,Te=Object(A["a"])(Ce,l,u,!1,null,"bb708f9e",null),ke=Te.exports,Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"projects"}},[e.state.projects.length<1?n("div",{staticClass:"no-projects"},[n("h3",{staticClass:"no-projects-text"},[e._v("No projects have been created.")]),n("UiButton",{attrs:{size:"large",icon:"arrow_back"},on:{click:e.close}},[e._v(" Back ")])],1):e._e(),n("div",{staticClass:"project-tiles"},[e._l(e.state.projects,(function(t){return[n("div",{key:t.id,staticClass:"project-tile-holder"},[n("div",{staticClass:"project-tile"},[n("p",{staticClass:"project-name"},[e._v(e._s(t.name))]),n("p",{staticClass:"project-date"},[e._v(e._s(e.formatDate(t.lastModified))+" "+e._s(e.formatTime(t.lastModified)))]),n("div",{staticClass:"project-actions"},[n("UiIconButton",{staticClass:"project-action",attrs:{icon:"launch",size:"small"},on:{click:function(n){return e.openProject(t)}}}),n("UiIconButton",{staticClass:"project-action",attrs:{icon:"delete",size:"small"},on:{click:function(n){return e.deleteProject(t)}}})],1)])])]}))],2)])},_e=[],Oe=(n("c975"),n("a434"),{name:"Projects",data:function(){return{state:vt}},methods:{close:function(){vt.header=null,vt.activeView="welcome"},formatDate:H,formatTime:te,deleteProject:function(e){var t=vt.projects.indexOf(e);vt.projects.splice(t,1),ht.delete("projects","id",e.id)},openProject:function(e){vt.project=e,vt.header=e.name,vt.activeView="editor"}},components:{UiButton:c["UiButton"],UiIconButton:c["UiIconButton"]}}),Be=Oe,Se=(n("d9dd"),Object(A["a"])(Be,Ue,_e,!1,null,"b7f7164e",null)),De=Se.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"templates"}},[e.state.templates.length>0?n("div",{staticClass:"templates-actions"},[n("UiButton",{attrs:{size:"large",icon:"playlist_add"},on:{click:e.newTemplate}},[e._v(" New Template ")])],1):n("div",{staticClass:"no-templates"},[n("h3",{staticClass:"no-templates-text"},[e._v("No project templates have been created.")]),n("UiButton",{attrs:{size:"large",icon:"playlist_add"},on:{click:e.newTemplate}},[e._v(" New Template ")])],1),n("div",{staticClass:"template-tiles"},[e._l(e.state.templates,(function(t){return[n("div",{key:t.id,staticClass:"template-tile-holder"},[n("div",{staticClass:"template-tile"},[n("p",{staticClass:"template-name"},[e._v(e._s(t.name))]),n("p",{staticClass:"template-date"},[e._v(e._s(e.formatDate(t.lastUsed))+" "+e._s(e.formatTime(t.lastUsed)))]),n("div",{staticClass:"template-actions"},[n("UiIconButton",{staticClass:"template-action",attrs:{icon:"edit",size:"small"},on:{click:function(n){e.currentTemplate=t,e.editOpen=!0}}}),n("UiIconButton",{staticClass:"template-action",attrs:{icon:"delete",size:"small"},on:{click:function(n){return e.deleteTemplate(t)}}})],1)])])]}))],2),e.editOpen?n("ProjectCreateEdit",{attrs:{edit:!0,project:e.currentTemplate},on:{close:e.editClose}}):e._e()],1)},Ee=[],Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("UiModal",{ref:"modal",attrs:{size:"large",title:e.edit?"Edit project template":"New project",dismissOn:"close-button esc"},on:{hide:e.close}},[e.existingTemplates.length>0?n("div",{staticClass:"template-selection"},[n("UiSelect",{attrs:{placeholder:"Use an existing template",options:e.existingTemplates,disabled:e.continuing},model:{value:e.existingTemplate,callback:function(t){e.existingTemplate=t},expression:"existingTemplate"}})],1):e._e(),n("UiTextbox",{attrs:{label:"Project name",error:"A name must be provided.",disabled:e.continuing,invalid:!e.nameValid},model:{value:e.template.name,callback:function(t){e.$set(e.template,"name",t)},expression:"template.name"}}),n("UiSelect",{attrs:{label:"Unit of distance",options:e.template.distanceUnits,disabled:e.continuing},model:{value:e.template.distanceUnit,callback:function(t){e.$set(e.template,"distanceUnit",t)},expression:"template.distanceUnit"}}),n("UiSelect",{attrs:{label:"Basis of distances",options:["Grid","Ground"],disabled:e.continuing},model:{value:e.template.distanceBasisType,callback:function(t){e.$set(e.template,"distanceBasisType",t)},expression:"template.distanceBasisType"}}),"Ground"===e.template.distanceBasisType?n("UiSelect",{attrs:{label:"Basis of bearings",options:["Grid","True/geodetic north","Magnetic north","None"],disabled:e.continuing},model:{value:e.template.bearingBasisType,callback:function(t){e.$set(e.template,"bearingBasisType",t)},expression:"template.bearingBasisType"}}):e._e(),"Grid"===e.template.distanceBasisType||"Grid"===e.template.bearingBasisType?n("UiSelect",{attrs:{label:"Coordinate reference system of the grid",placeholder:"Search a projection name, location, or SRID code",disableFilter:!0,hasSearch:!0,loading:e.crsLoading,"no-results":e.crsNoResult,options:e.crsOptions,error:"A coordinate reference system must be specified.",disabled:e.continuing,invalid:!e.crsValid},on:{"query-change":e.crsQuery},model:{value:e.template.crs,callback:function(t){e.$set(e.template,"crs",t)},expression:"template.crs"}}):e._e(),"Magnetic north"===e.template.bearingBasisType?n("UiDatepicker",{attrs:{customFormatter:e.formatDate,label:"Date of survey (approximate)",error:"A date must be provided.",disabled:e.continuing,invalid:!e.dateValid},model:{value:e.template.bearingBasisDate,callback:function(t){e.$set(e.template,"bearingBasisDate",t)},expression:"template.bearingBasisDate"}}):e._e(),!e.edit&&e.isValid?n("UiButton",{staticClass:"continue",attrs:{size:"large",icon:"library_add",loading:e.continuing},on:{click:e.createProject}},[e._v(" Create ")]):e._e()],1)},Ne=[],Ie=(n("b64b"),n("2532"),{name:"ProjectCreateEdit",mounted:function(){this.$refs.modal.open()},props:{edit:{default:!1,type:Boolean},project:{default:function(){return new be},type:Object}},computed:{crsValid:function(){if("Grid"===this.template.distanceBasisType||"Grid"===this.template.bearingBasisType){var e=Object.keys(this.template.crs);return e.includes("label")&&e.includes("value")}return!0},dateValid:function(){return"Magnetic north"!==this.template.bearingBasisType||this.template.bearingBasisDate instanceof Date},existingTemplates:function(){return this.edit?[]:vt.templates.map((function(e){return{label:"Template: "+e.name,value:e}}))},isValid:function(){return this.crsValid&&this.dateValid&&this.nameValid},nameValid:function(){return this.template.name.length>0}},data:function(){return{continuing:!1,crsLoading:!1,crsNoResult:!1,crsOptions:[],existingTemplate:{},template:this.project}},methods:{close:function(){this.$emit("close")},createProject:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.continuing=!0,t.next=3,ve.fromTemplate(e.template);case 3:return n=t.sent,vt.projects.push(n),i=n.id,a=n.lastModified,r=n.name,t.next=8,ht.insert("projects",{id:i,lastModified:a,name:r});case 8:vt.project=n,e.$refs.modal.close(),vt.header=r,vt.activeView="editor";case 12:case"end":return t.stop()}}),t)})))()},crsQuery:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.crsLoading=!0,F.queryProj(e).then((function(e){t.crsNoResult=!1,t.crsOptions=e.map((function(e){return{label:"SRID:".concat(e.code," – ").concat(e.name),value:e}}))})).catch((function(){return t.crsNoResult=!0})).finally((function(){return t.crsLoading=!1}));case 2:case"end":return n.stop()}}),n)})))()},formatDate:H},watch:{"template.bearingBasisType":function(e){"Grid"!==e&&"Grid"!==this.template.distanceBasisType&&(this.template.crs={}),"Magnetic north"!==e&&(this.template.bearingBasisDate=null)},"template.distanceBasisType":function(e){"Grid"===e?this.template.bearingBasisType="Grid":"Grid"!==this.template.bearingBasisType&&(this.template.crs={})},existingTemplate:function(e){var t=e.value;for(var n in t)["distanceUnits","id"].includes(n)||(this.template[n]=t[n])}},components:{UiButton:c["UiButton"],UiDatepicker:c["UiDatepicker"],UiModal:c["UiModal"],UiSelect:c["UiSelect"],UiTextbox:c["UiTextbox"]}}),Pe=Ie,Fe=(n("1ca7"),Object(A["a"])(Pe,Me,Ne,!1,null,"1e32aeae",null)),Ge=Fe.exports,$e={name:"Templates",data:function(){return{state:vt,currentTemplate:{},editOpen:!1}},methods:{close:function(){vt.activeView="welcome",vt.header=null},editClose:function(){this.editOpen=!1;var e=this.currentTemplate,t=e.id,n=e.bearingBasisDate,i=e.bearingBasisType,a=e.crs,r=e.distanceBasisType,o=e.distanceUnit,s=e.lastUsed,c=e.name;ht.insert("templates",{id:t,bearingBasisDate:n,bearingBasisType:i,crs:Object(d["a"])({},a),distanceBasisType:r,distanceUnit:Object(d["a"])({},o),lastUsed:s,name:c},!0)},formatDate:H,formatTime:te,deleteTemplate:function(e){var t=vt.templates.indexOf(e);vt.templates.splice(t,1),ht.delete("templates","id",e.id)},newTemplate:function(){var e=new be;vt.templates.push(e),this.currentTemplate=e,this.editOpen=!0}},components:{ProjectCreateEdit:Ge,UiButton:c["UiButton"],UiIconButton:c["UiIconButton"]}},Ae=$e,Ve=(n("4732"),Object(A["a"])(Ae,Re,Ee,!1,null,"2c70d9e9",null)),Ye=Ve.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"welcome"}},[n("div",{attrs:{id:"welcome-columns"}},[n("div",{staticClass:"welcome-column"},[n("div",{staticClass:"welcome-group",staticStyle:{flex:"0 0 auto"}},[n("h2",{staticClass:"welcome-group-title"},[e._v("Projects")]),n("div",{staticClass:"welcome-tile-group"},[n("UiButton",{staticClass:"welcome-tile",attrs:{icon:"add"},on:{click:e.newProject}},[n("div",[n("p",[e._v("Start new project")])])]),n("UiButton",{staticClass:"welcome-tile",attrs:{icon:"folder_open"},on:{click:e.openProjects}},[n("div",[n("p",[e._v("Open existing project")])])]),n("UiButton",{staticClass:"welcome-tile",attrs:{icon:"playlist_add"},on:{click:e.openTemplates}},[n("div",[n("p",[e._v("Manage templates")]),n("p",[e._v("Use templates to create new projects more quickly.")])])])],1)]),n("div",{staticClass:"welcome-group",staticStyle:{flex:"1 1 auto",height:"0"}},[e.state.projects.length>0?n("h3",{staticClass:"welcome-subgroup-title",staticStyle:{flex:"0 0 auto"}},[e._v("Recent")]):e._e(),n("div",{ref:"recentProjectTiles",staticClass:"welcome-tile-group",staticStyle:{flex:"1 1 auto",height:"0"}},[e._l(e.recentProjects,(function(t){return[n("UiButton",{key:t.id,staticClass:"welcome-tile",on:{click:function(n){return e.loadProject(t)}}},[n("div",[n("p",[e._v(e._s(t.name))]),n("p",[e._v("Last modified on "+e._s(e.formatDate(t.lastModified))+" at "+e._s(e.formatTime(t.lastModified)))])])])]}))],2)])]),n("div",{staticClass:"welcome-column"},[n("div",{staticClass:"welcome-group"},[n("h2",{staticClass:"welcome-group-title"},[e._v("Settings")]),n("div",{staticClass:"welcome-tile-group"},[n("UiButton",{staticClass:"welcome-tile",attrs:{icon:"keyboard"},on:{click:e.openInputSettings}},[n("div",[n("p",[e._v("Input")]),n("p",[e._v("Key bindings, direction and distance formats...")])])]),n("UiButton",{staticClass:"welcome-tile",attrs:{icon:"color_lens"},on:{click:e.openAppearanceSettings}},[n("div",[n("p",[e._v("Appearance")]),n("p",[e._v("Colors, font sizes, date and time formats...")])])])],1)])])]),n("AppearanceSettings",{ref:"appearanceSettings"}),n("InputSettings",{ref:"inputSettings"}),e.projectCreateOpen?n("ProjectCreateEdit",{on:{close:function(t){e.projectCreateOpen=!1}}}):e._e()],1)},ze=[],We=(n("a630"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("UiModal",{ref:"modal",attrs:{id:"appearance-settings",size:"large",title:"Appearance",dismissOn:"close-button esc"},on:{close:e.save}},[n("div",{staticClass:"settings-section"},[n("h2",{staticClass:"settings-section-title"},[e._v("Colors")]),n("div",{staticClass:"settings-group"},[n("div",{staticClass:"setting"},[n("h3",[e._v("Primary")]),n("ColorPicker",{model:{value:e.color1,callback:function(t){e.color1=t},expression:"color1"}})],1),n("div",{staticClass:"setting"},[n("h3",[e._v("Secondary")]),n("ColorPicker",{model:{value:e.color2,callback:function(t){e.color2=t},expression:"color2"}})],1),n("div",{staticClass:"setting"},[n("h3",[e._v("Text")]),n("ColorPicker",{model:{value:e.colorText,callback:function(t){e.colorText=t},expression:"colorText"}})],1)]),n("UiCheckbox",{attrs:{label:"Invert color of documents in editor"},model:{value:e.darkEditor,callback:function(t){e.darkEditor=t},expression:"darkEditor"}})],1),n("div",{staticClass:"settings-section"},[n("h2",{staticClass:"settings-section-title"},[e._v("Dates and times")]),n("div",{staticClass:"settings-group"},[n("div",{staticClass:"setting"},[n("UiSelect",{attrs:{label:"Date format",options:["YYYY-MM-DD","MM/DD/YYYY","DD/MM/YYYY"]},model:{value:e.dateFormat,callback:function(t){e.dateFormat=t},expression:"dateFormat"}})],1),n("div",{staticClass:"setting"},[n("UiSelect",{attrs:{label:"Time format",options:["12-hour","24-hour"]},model:{value:e.timeFormat,callback:function(t){e.timeFormat=t},expression:"timeFormat"}})],1)])])])}),qe=[],Je=n("c345"),Ke={name:"AppearanceSettings",data:function(){return vt.appearance},methods:{open:function(){this.$refs.modal.open()},save:function(){var e=vt.appearance,t=e.color1,n=e.color2,i=e.colorText,a=e.darkEditor,r=e.dateFormat,o=e.timeFormat;ht.insert("settings",{id:1,color1:"string"===typeof t?t:t.hex,color2:"string"===typeof n?n:n.hex,colorText:"string"===typeof i?i:i.hex,darkEditor:a,dateFormat:r,timeFormat:o},!0)}},watch:{color1:function(e){return re(e.hex)},color2:function(e){return ae(e.hex)},colorText:function(e){return se(e.hex)},darkEditor:function(e){return oe(e?"black":"white")}},components:{ColorPicker:Je["Chrome"],UiCheckbox:c["UiCheckbox"],UiModal:c["UiModal"],UiSelect:c["UiSelect"]}},Ze=Ke,Qe=(n("9e23"),n("73af"),Object(A["a"])(Ze,We,qe,!1,null,"2bf9a3f4",null)),He=Qe.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("UiModal",{ref:"modal",attrs:{id:"input-settings",size:"large",title:"Input",dismissOn:"close-button esc"},on:{close:e.save}},[n("div",{staticClass:"settings-section"},[n("h2",{staticClass:"settings-section-title"},[e._v("Direction and distance")]),n("div",{staticClass:"settings-group"},[n("div",{staticClass:"setting"},[n("UiSelect",{attrs:{label:"Direction format",options:["45.56","N 45-33-36 E","N 45.33.36 E"],help:"When inputting, letters are case insensitive and spaces are ignored"},model:{value:e.directionFormat,callback:function(t){e.directionFormat=t},expression:"directionFormat"}})],1),n("div",{staticClass:"setting"},[n("UiSelect",{attrs:{label:"Distance format",options:["1234.56","1234,56","1,234.56","1.234,56","1 234.56","1 234,56"],help:"When inputting, spaces are ignored"},model:{value:e.distanceFormat,callback:function(t){e.distanceFormat=t},expression:"distanceFormat"}})],1)])]),n("div",{staticClass:"settings-section"},[n("h2",{staticClass:"settings-section-title"},[e._v("Key bindings")]),n("div",{staticClass:"key-bindings"},[e._l(e.hotkeys,(function(t,i){return[n("div",{key:i,staticClass:"key-binding"},[n("p",[e._v(e._s(t.name))]),n("UiTextbox",{staticClass:"key-combo",attrs:{disabled:!0},model:{value:t.display,callback:function(n){e.$set(t,"display",n)},expression:"hotkey.display"}})],1)]}))],2)])])},et=[],tt={name:"InputSettings",data:function(){return vt.input},methods:{open:function(){this.$refs.modal.open()},save:function(){}},components:{UiModal:c["UiModal"],UiSelect:c["UiSelect"],UiTextbox:c["UiTextbox"]}},nt=tt,it=(n("1ed9"),n("33ad"),Object(A["a"])(nt,Xe,et,!1,null,"5122c63e",null)),at=it.exports,rt={name:"Welcome",data:function(){return{state:vt,projectCreateOpen:!1,recentProjects:[]}},mounted:function(){if(vt.projects.length>0){var e=this.$refs.recentProjectTiles.clientHeight,t=6*ne();this.recentProjects=Array.from(vt.projects).sort((function(e,t){return t.lastModified.valueOf()-e.lastModified.valueOf()})).slice(0,Math.floor(e/t))}},methods:{formatDate:H,formatTime:te,loadProject:function(e){vt.project=e,vt.header=e.name,vt.activeView="editor"},newProject:function(){this.projectCreateOpen=!0},openAppearanceSettings:function(){this.$refs.appearanceSettings.open()},openInputSettings:function(){this.$refs.inputSettings.open()},openProjects:function(){vt.header="Projects",vt.activeView="projects"},openTemplates:function(){vt.header="Project Templates",vt.activeView="templates"}},components:{AppearanceSettings:He,InputSettings:at,ProjectCreateEdit:Ge,UiButton:c["UiButton"]}},ot=rt,st=(n("abb3"),n("a663"),Object(A["a"])(ot,Le,ze,!1,null,"5fba9014",null)),ct=st.exports,lt={name:"App",data:function(){return vt},methods:{home:function(){vt.header=null,vt.activeView="welcome"}},components:{Editor:ke,Projects:De,Templates:Ye,UiIconButton:c["UiIconButton"],UiToolbar:c["UiToolbar"],Welcome:ct}},ut=lt,dt=(n("2979"),Object(A["a"])(ut,o,s,!1,null,"1ad1aedb",null)),pt=dt.exports,mt=n("b34e"),ft=function(){function e(){Object(_["a"])(this,e),this.schema=mt["schema"].create("platmaster",1),this.schema.createTable("history").addColumn("id",mt["Type"].INTEGER).addColumn("projectId",mt["Type"].STRING).addColumn("type",mt["Type"].STRING).addColumn("featureId",mt["Type"].STRING).addPrimaryKey(["id"],!0),this.schema.createTable("projects").addColumn("id",mt["Type"].STRING).addColumn("lastModified",mt["Type"].DATE_TIME).addColumn("name",mt["Type"].STRING).addPrimaryKey(["id"],!1),this.schema.createTable("settings").addColumn("id",mt["Type"].INTEGER).addColumn("color1",mt["Type"].STRING).addColumn("color2",mt["Type"].STRING).addColumn("colorText",mt["Type"].STRING).addColumn("darkEditor",mt["Type"].BOOLEAN).addColumn("dateFormat",mt["Type"].STRING).addColumn("timeFormat",mt["Type"].STRING).addPrimaryKey(["id"],!0),this.schema.createTable("templates").addColumn("id",mt["Type"].STRING).addColumn("bearingBasisDate",mt["Type"].DATE_TIME).addColumn("bearingBasisType",mt["Type"].STRING).addColumn("crs",mt["Type"].OBJECT).addColumn("distanceBasisType",mt["Type"].STRING).addColumn("distanceUnit",mt["Type"].OBJECT).addColumn("lastUsed",mt["Type"].DATE_TIME).addColumn("name",mt["Type"].STRING).addPrimaryKey(["id"],!1).addNullable(["crs","bearingBasisDate"])}return Object(O["a"])(e,[{key:"delete",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,i){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this.db.getSchema().table(t),e.abrupt("return",this.db.delete().from(a).where(a[n].eq(i)).exec());case 2:case"end":return e.stop()}}),e,this)})));function t(t,n,i){return e.apply(this,arguments)}return t}()},{key:"initialize",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.schema.connect();case 2:this.db=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"insert",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var i,a,r,o,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],console.log(t,n,i),a=this.db.getSchema().table(t),r=Object(d["a"])({},n),r.id||(r.id=0),o=a.createRow(r),s=i?this.db.insertOrReplace():this.db.insert(),e.abrupt("return",s.into(a).values([o]).exec());case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"select",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,o,s,c,l,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:[],a=this.db.getSchema().table(t),r=this.db.select().from(a),!(n.length>0)){e.next=8;break}return o=Object(i["a"])(n,3),s=o[0],c=o[1],l=o[2],e.abrupt("return",r.where(a[s][c](l)).exec());case 8:return e.abrupt("return",r.exec());case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,a,r){var o,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(o=this.db.getSchema().table(t),s=this.db.update(o),c=0,l=Object.entries(r);c<l.length;c++)u=Object(i["a"])(l[c],2),d=u[0],p=u[1],s=s.set(o[d],p);return e.abrupt("return",s.where(o[n].eq(a)).exec());case 4:case"end":return e.stop()}}),e,this)})));function t(t,n,i,a){return e.apply(this,arguments)}return t}()}]),e}();n.d(t,"db",(function(){return ht})),n.d(t,"state",(function(){return vt}));var ht=new ft,vt={activeView:"welcome",appearance:{color1:"#283354",color2:"#212B48",colorText:"#DDE6FF",darkEditor:!1,dateFormat:"YYYY-MM-DD",timeFormat:"12-hour"},header:null,input:{directionFormat:"N 45.33.36 E",distanceFormat:"1234.56",hotkeys:{continueLine:{name:"Line tool: Repeat direction",combo:"alt+w",display:"Alt + W"},drawLine:{name:"Line tool: Activate",combo:"alt+a",display:"Alt + A"},repeat:{name:"Line tool: Repeat direction and distance",combo:"alt+d",display:"Alt + D"},undo:{name:"Undo",combo:"alt+z",display:"Alt + Z"}}},project:null,projects:[],templates:[]};Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,a,o,s,c,l,u,d,p,m,f,h,v,b,g,y,w,j,x,C,T,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ht.initialize();case 2:return e.next=4,Promise.all([ht.select("projects"),ht.select("settings",["id","eq",1]),ht.select("templates")]);case 4:for(t=e.sent,n=Object(i["a"])(t,3),a=n[0],o=n[1],s=n[2],c=!0,l=!1,u=void 0,e.prev=12,d=a[Symbol.iterator]();!(c=(p=d.next()).done);c=!0){for(h in m=p.value,f=new ve,f)m[h]&&(f[h]=m[h]);vt.projects.push(f)}e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),l=!0,u=e.t0;case 20:e.prev=20,e.prev=21,c||null==d.return||d.return();case 23:if(e.prev=23,!l){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:if(o.length>0)for(b in v=o[0],vt.appearance)v[b]&&(vt.appearance[b]=v[b]);for(g=!0,y=!1,w=void 0,e.prev=32,j=s[Symbol.iterator]();!(g=(x=j.next()).done);g=!0){for(k in C=x.value,T=new be,T)C[k]&&(T[k]=C[k]);vt.templates.push(T)}e.next=40;break;case 36:e.prev=36,e.t1=e["catch"](32),y=!0,w=e.t1;case 40:e.prev=40,e.prev=41,g||null==j.return||j.return();case 43:if(e.prev=43,!y){e.next=46;break}throw w;case 46:return e.finish(43);case 47:return e.finish(40);case 48:ae(vt.appearance.color2),re(vt.appearance.color1),oe(vt.appearance.darkEditor?"black":"white"),se(vt.appearance.colorText),new r["a"]({render:function(e){return e(pt)}}).$mount("#app"),console.log(vt);case 54:case"end":return e.stop()}}),e,null,[[12,16,20,28],[21,,23,27],[32,36,40,48],[41,,43,47]])})))()},"68c9":function(e,t,n){},"6d5b":function(e,t,n){},"72c1":function(e,t,n){},"73af":function(e,t,n){"use strict";var i=n("a045"),a=n.n(i);a.a},"79e1":function(e,t,n){},8896:function(e,t,n){},9040:function(e,t,n){"use strict";var i=n("3b19"),a=n.n(i);a.a},9795:function(e,t,n){"use strict";var i=n("2bae"),a=n.n(i);a.a},"9e23":function(e,t,n){"use strict";var i=n("6d5b"),a=n.n(i);a.a},"9e3c":function(e,t,n){},a045:function(e,t,n){},a663:function(e,t,n){"use strict";var i=n("79e1"),a=n.n(i);a.a},abb3:function(e,t,n){"use strict";var i=n("72c1"),a=n.n(i);a.a},c26c:function(e,t,n){},c613:function(e,t,n){},d1b3:function(e,t,n){},d34f:function(e,t,n){},d9dd:function(e,t,n){"use strict";var i=n("68c9"),a=n.n(i);a.a},fe81:function(e,t,n){"use strict";var i=n("d1b3"),a=n.n(i);a.a},fff7:function(e,t,n){"use strict";var i=n("8896"),a=n.n(i);a.a}});
//# sourceMappingURL=app.8de288f8.js.map